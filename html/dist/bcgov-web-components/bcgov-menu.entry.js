import{r as i,h as e,H as t,g as s}from"./index-9727947e.js";import{m as n,a,k as o}from"./utils-c2c867e8.js";const l=class{constructor(e){i(this,e),this.alignment="left",this.menuId="menu",this.instructions="Use arrow keys to navigate between menuitems,\n  spacebar to expand submenus, escape key to close submenus, enter to activate menuitems.",this.breakpoint=0,this.hamburger=!0,this.active=!1,this.allowHover=!1,this.menuTimeOut=500,this.isSubmenu=!1,this.showSubmenu=(i,e)=>{if(!this.isSubmenu)return;e?i.classList.add("expanded"):i.classList.remove("expanded"),i.setAttribute("aria-expanded",e?"true":"false"),i.setAttribute("tabindex",e?"-1":"0");const t=i.querySelector("ul");null!==t&&(t.setAttribute("aria-hidden",e?"false":"true"),e)&&i.querySelector("ul > li:first-child").setAttribute("tabindex","0")}}componentWillLoad(){this.isSubmenu="UL"===this.el.parentElement.nodeName,[].forEach.call(this.el.querySelectorAll("a"),(function(i){n(i)}));const i=this;this.bodyTag=document.getElementsByTagName("BODY")[0],this.isSubmenu||(this.isDesktop(),window.addEventListener("resize",(function(){i.isDesktop()})))}componentDidRender(){if(this.isSubmenu){this.el.setAttribute("aria-haspopup",!0),this.el.setAttribute("aria-expanded",!1),this.el.setAttribute("tabindex",-1);const i=this.el.closest("bcgov-menu[primary]");null!==i&&(this.allowHover=this.allowHover||i.hasAttribute("allow-hover"),this.menuTimeOut=i.hasAttribute("menu-time-out")?i.getAttribute("menu-time-out"):this.menuTimeOut)}else{const i=this.el.querySelector("ul > *:first-child");null!==i&&i.setAttribute("tabindex",0)}}isDesktop(){let i=!1;if(this.isSubmenu){let e=a(this.el,"bcgov-menu");if(null!==e&&e.getAttribute("breakpoint")){const t=parseInt(e.getAttribute("breakpoint"));i=window.innerWidth>=t}}else window.innerWidth>=this.breakpoint?(this.el.classList.contains("is-desktop")||this.el.classList.add("is-desktop"),void 0!==this.primary&&(this.bodyTag.classList.contains("bcgov-menu-primary-is-desktop")||this.bodyTag.classList.add("bcgov-menu-primary-is-desktop")),i=!0):(this.el.classList.remove("is-desktop"),void 0!==this.primary&&this.bodyTag.classList.remove("bcgov-menu-primary-is-desktop"));return i}onMouseEnter(i){this.isDesktop()&&this.allowHover&&this.showSubmenu(i.target,!0)}onMouseLeave(i){if(this.isDesktop()&&this.allowHover){const e=i.target,t=this;clearTimeout(this.menuTimeOutState),this.menuTimeOutState=setTimeout((function(){t.showSubmenu(e,!1)}),t.menuTimeOut),this.isSubmenu||[].forEach.call(this.el.querySelectorAll("ul > *"),(function(i){i.setAttribute("tabindex",-1),i.blur()}))}}onClick(i){const e=i.target,t=a(e,"bcgov-menu");null===e.closest(".bcgov-primary-menu-close")&&this.showSubmenu(t,!t.classList.contains("expanded")),"close-menu-mobile"===e.parentElement.getAttribute("id")&&t.classList.add("target-hidden")}onKeyDown(i){const e=i.srcElement;switch(i.keyCode){case o.enter:e.querySelector("a").click();case o.space:i.preventDefault(),i.stopPropagation(),this.showSubmenu(this.el,!0),this.el.querySelector("ul > li:first-child").focus();break;case o.esc:i.preventDefault(),i.stopPropagation(),this.showSubmenu(this.el,!1),this.el.focus();break;case o.right:i.preventDefault(),this.focusChange(e,"next");break;case o.left:i.preventDefault(),this.focusChange(e,"prev");break;case o.up:i.preventDefault(),this.focusChange(e,"up");break;case o.down:i.preventDefault(),this.focusChange(e,"down")}}focusChange(i,e="next"){let t;i===this.el.querySelector("ul")?(t=i.querySelector("li:first-child"),t=this.isDesktop()?t.nextElementSibling:t,i=t):"next"===e||"down"===e?t=i.nextElementSibling:"prev"!=e&&"up"!==e||(t=i.previousElementSibling);const s=null!==a(i,'ul[role="menu"]');(s&&("up"===e||"down"===e)||!s&&("prev"===e||"next"===e))&&(null==t||"LI"!==i.nodeName&&"BCGOV-MENU"!==i.nodeName||(i.setAttribute("tabindex","-1"),t.setAttribute("tabindex","0"),t.focus()))}render(){const i="align-"+this.alignment,s="bcgov-instructions-"+this.menuId;let n="expandable";if(this.isSubmenu)return void 0!==this.active&&this.active&&(n+=" active"),e(t,{role:"menuitem",class:n,"aria-label":this.name},e("div",null,e("a",{href:this.href,tabindex:"-1"},this.name),e("span",null),e("slot",{name:"submenu-link"})),e("ul",{role:"menu","aria-hidden":"true"},e("slot",null)));{const n={role:"menubar",tabindex:"0",class:i};return void 0!==this.primary&&(n["aria-labelledby"]=s),void 0!==this.sidebar&&(n.class+=" sidebar-menu"),e(t,null,e("ul",Object.assign({},n),void 0!==this.primary&&e("li",{role:"menuitem",class:"bcgov-primary-menu-close",tabindex:"-1","aria-hidden":"true","aria-labelId":"close-menu-mobile"},e("a",{href:"#","aria-label":"Close Mobile Menu",id:"close-menu-mobile"},e("span",null,"x"))),e("slot",null)),void 0!==this.primary&&e("div",{class:"sr-only","aria-hidden":"true",id:s},this.instructions))}}get el(){return s(this)}};export{l as bcgov_menu}